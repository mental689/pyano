/*! @name videojs-overlay @version 2.1.1 @license Apache-2.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/window"],e):t.videojsOverlay=e(t.videojs,t.window)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},r={align:"top-left",class:"",content:"This overlay will show up while the video is playing",debug:!1,showBackground:!0,attachToControlBar:!1,overlays:[{start:"playing",end:"paused"}]},i=t.getComponent("Component"),s=t.dom||t,a=t.registerPlugin||t.plugin,h=function(t){return"number"==typeof t&&t==t},d=function(t){return"string"==typeof t&&/^\S+$/.test(t)},l=function(r){function i(t,e){n(this,i);var s=o(this,r.call(this,t,e));return["start","end"].forEach(function(t){var e=s.options_[t];if(h(e))s[t+"Event_"]="timeupdate";else if(d(e))s[t+"Event_"]=e;else if("start"===t)throw new Error('invalid "start" option; expected number or string')}),["endListener_","rewindListener_","startListener_"].forEach(function(t){s[t]=function(e){return i.prototype[t].call(s,e)}}),"timeupdate"===s.startEvent_&&s.on(t,"timeupdate",s.rewindListener_),s.debug('created, listening to "'+s.startEvent_+'" for "start" and "'+(s.endEvent_||"nothing")+'" for "end"'),s.hide(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,r),i.prototype.createEl=function(){var t=this.options_,n=t.content,o=t.showBackground?"vjs-overlay-background":"vjs-overlay-no-background",r=s.createEl("div",{className:"\n        vjs-overlay\n        vjs-overlay-"+t.align+"\n        "+t.class+"\n        "+o+"\n        vjs-hidden\n      "});return"string"==typeof n?r.innerHTML=n:n instanceof e.DocumentFragment?r.appendChild(n):s.appendContent(r,n),r},i.prototype.debug=function(){if(this.options_.debug){for(var e=t.log,n=e,o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];e.hasOwnProperty(r[0])&&"function"==typeof e[r[0]]&&(n=e[r.shift()]),n.apply(void 0,["overlay#"+this.id()+": "].concat(r))}},i.prototype.hide=function(){return r.prototype.hide.call(this),this.debug("hidden"),this.debug('bound `startListener_` to "'+this.startEvent_+'"'),this.endEvent_&&(this.debug('unbound `endListener_` from "'+this.endEvent_+'"'),this.off(this.player(),this.endEvent_,this.endListener_)),this.on(this.player(),this.startEvent_,this.startListener_),this},i.prototype.shouldHide_=function(t,e){var n=this.options_.end;return h(n)?t>=n:n===e},i.prototype.show=function(){return r.prototype.show.call(this),this.off(this.player(),this.startEvent_,this.startListener_),this.debug("shown"),this.debug('unbound `startListener_` from "'+this.startEvent_+'"'),this.endEvent_&&(this.debug('bound `endListener_` to "'+this.endEvent_+'"'),this.on(this.player(),this.endEvent_,this.endListener_)),this},i.prototype.shouldShow_=function(t,e){var n=this.options_.start,o=this.options_.end;return h(n)?h(o)?t>=n&&t<o:this.hasShownSinceSeek_?Math.floor(t)===n:(this.hasShownSinceSeek_=!0,t>=n):n===e},i.prototype.startListener_=function(t){var e=this.player().currentTime();this.shouldShow_(e,t.type)&&this.show()},i.prototype.endListener_=function(t){var e=this.player().currentTime();this.shouldHide_(e,t.type)&&this.hide()},i.prototype.rewindListener_=function(t){var e=this.player().currentTime(),n=this.previousTime_,o=this.options_.start,r=this.options_.end;e<n&&(this.debug("rewind detected"),h(r)&&!this.shouldShow_(e)?(this.debug("hiding; "+r+" is an integer and overlay should not show at this time"),this.hasShownSinceSeek_=!1,this.hide()):d(r)&&e<o&&(this.debug("hiding; show point ("+o+") is before now ("+e+") and end point ("+r+") is an event"),this.hasShownSinceSeek_=!1,this.hide())),this.previousTime_=e},i}(i);t.registerComponent("Overlay",l);var u=function(e){var n=this,o=t.mergeOptions(r,e);Array.isArray(this.overlays_)&&this.overlays_.forEach(function(t){n.removeChild(t),n.controlBar&&n.controlBar.removeChild(t),t.dispose()});var i=o.overlays;delete o.overlays,this.overlays_=i.map(function(e){var r=t.mergeOptions(o,e),i="string"==typeof r.attachToControlBar||!0===r.attachToControlBar;if(!n.controls()||!n.controlBar)return n.addChild("overlay",r);if(i&&-1!==r.align.indexOf("bottom")){var s=n.controlBar.children()[0];if(void 0!==n.controlBar.getChild(r.attachToControlBar)&&(s=n.controlBar.getChild(r.attachToControlBar)),s){var a=n.controlBar.addChild("overlay",r);return n.controlBar.el().insertBefore(a.el(),s.el()),a}}var h=n.addChild("overlay",r);return n.el().insertBefore(h.el(),n.controlBar.el()),h})};return u.VERSION="__VERSION__",a("overlay",u),u});
